{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/MAC/Projects%202/buildpcbs-eda-demo/src/components/PCBRenderer.tsx"],"sourcesContent":["\nimport React, { useRef, useEffect, useState } from 'react';\nimport * as THREE from 'three';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';\nimport { Component } from '../types';\n\ninterface Props {\n  components: Component[];\n  selectedId: string | null;\n  onSelect: (id: string | null) => void;\n  contextMap?: Record<string, string>;\n}\n\nconst PCBRenderer: React.FC<Props> = ({ components, selectedId, onSelect, contextMap = {} }) => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const sceneRef = useRef<THREE.Scene | null>(null);\n  const cameraRef = useRef<THREE.PerspectiveCamera | null>(null);\n  const rendererRef = useRef<THREE.WebGLRenderer | null>(null);\n  const groupRef = useRef<THREE.Group>(new THREE.Group());\n  const [hoveredId, setHoveredId] = useState<string | null>(null);\n  const [labelPos, setLabelPos] = useState({ x: 0, y: 0 });\n\n  useEffect(() => {\n    if (!containerRef.current) return;\n\n    const scene = new THREE.Scene();\n    scene.background = new THREE.Color(0xFFFFFF); // White background\n    sceneRef.current = scene;\n\n    const camera = new THREE.PerspectiveCamera(\n      45,\n      containerRef.current.clientWidth / containerRef.current.clientHeight,\n      0.1,\n      2000\n    );\n    // Adjusted initial position for better overview\n    camera.position.set(100, 150, 100);\n    cameraRef.current = camera;\n\n    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });\n    renderer.setSize(containerRef.current.clientWidth, containerRef.current.clientHeight);\n    renderer.setPixelRatio(window.devicePixelRatio);\n    containerRef.current.appendChild(renderer.domElement);\n    rendererRef.current = renderer;\n\n    const controls = new OrbitControls(camera, renderer.domElement);\n    controls.enableDamping = true;\n    controls.dampingFactor = 0.05;\n    controls.autoRotate = false; // Ensure auto-rotate is off by default\n    controls.minDistance = 20;\n    controls.maxDistance = 500;\n\n    const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);\n    scene.add(ambientLight);\n    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);\n    directionalLight.position.set(100, 200, 100);\n    scene.add(directionalLight);\n\n    const boardGeom = new THREE.BoxGeometry(160, 1.6, 120);\n    // Darker board color for contrast on white background\n    const boardMat = new THREE.MeshStandardMaterial({ color: 0x1A1A1A, roughness: 0.2, metalness: 0.1 });\n    const board = new THREE.Mesh(boardGeom, boardMat);\n    board.position.y = -0.8;\n    scene.add(board);\n\n    // Grid color adjustment for white background\n    const grid = new THREE.GridHelper(400, 40, 0xE5E7EB, 0xF3F4F6);\n    grid.position.y = -1;\n    scene.add(grid);\n\n    scene.add(groupRef.current);\n\n    const raycaster = new THREE.Raycaster();\n    const mouse = new THREE.Vector2();\n\n    const updateMouse = (event: MouseEvent) => {\n      if (!containerRef.current) return;\n      const rect = containerRef.current.getBoundingClientRect();\n      mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;\n      mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;\n    };\n\n    const handleMouseMove = (event: MouseEvent) => {\n      updateMouse(event);\n      raycaster.setFromCamera(mouse, camera);\n      const intersects = raycaster.intersectObjects(groupRef.current.children);\n\n      if (intersects.length > 0) {\n        const id = intersects[0].object.userData.id;\n        setHoveredId(id);\n\n        // Project to screen\n        const vector = new THREE.Vector3();\n        intersects[0].object.getWorldPosition(vector);\n        vector.project(camera);\n\n        const rect = containerRef.current!.getBoundingClientRect();\n        setLabelPos({\n          x: (vector.x + 1) * rect.width / 2,\n          y: -(vector.y - 1) * rect.height / 2\n        });\n\n        // Change cursor to pointer if interactive\n        containerRef.current!.style.cursor = 'pointer';\n      } else {\n        setHoveredId(null);\n        containerRef.current!.style.cursor = 'default';\n      }\n    };\n\n    const handleClick = (event: MouseEvent) => {\n      updateMouse(event);\n      raycaster.setFromCamera(mouse, camera);\n      const intersects = raycaster.intersectObjects(groupRef.current.children);\n      if (intersects.length > 0) {\n        onSelect(intersects[0].object.userData.id);\n      } else {\n        onSelect(null);\n      }\n    };\n\n    containerRef.current.addEventListener('mousemove', handleMouseMove);\n    containerRef.current.addEventListener('click', handleClick);\n\n    const animate = () => {\n      requestAnimationFrame(animate);\n      controls.update();\n      renderer.render(scene, camera);\n    };\n    animate();\n\n    const handleResize = () => {\n      if (!containerRef.current) return;\n      camera.aspect = containerRef.current.clientWidth / containerRef.current.clientHeight;\n      camera.updateProjectionMatrix();\n      renderer.setSize(containerRef.current.clientWidth, containerRef.current.clientHeight);\n    };\n    window.addEventListener('resize', handleResize);\n\n    return () => {\n      window.removeEventListener('resize', handleResize);\n      containerRef.current?.removeEventListener('mousemove', handleMouseMove);\n      containerRef.current?.removeEventListener('click', handleClick);\n      renderer.dispose();\n      // Clean up geometry/materials to avoid leaks?\n    };\n  }, []);\n\n  useEffect(() => {\n    groupRef.current.clear();\n    components.forEach((comp) => {\n      let geometry;\n      if (comp.type.includes('IC')) {\n        geometry = new THREE.BoxGeometry(12, 4, 12);\n      } else if (comp.type.includes('Resistor') || comp.type.includes('Capacitor')) {\n        geometry = new THREE.BoxGeometry(4, 2, 2);\n      } else {\n        geometry = new THREE.CylinderGeometry(4, 4, 5, 32);\n      }\n\n      const isSelected = comp.id === selectedId;\n      const isHovered = comp.id === hoveredId;\n\n      // Highlight if has context\n      const hasContext = contextMap[comp.id];\n\n      // Updated material colors for white theme\n      // Default: dark grey/black for contrast\n      // Hover: slightly lighter\n      // Selected: Primary Blue\n      // Context: Light Blue highlight\n      const material = new THREE.MeshStandardMaterial({\n        color: isSelected ? 0x0038DF : (hasContext ? 0x00A8E8 : (isHovered ? 0x4B5563 : 0x1F2937)),\n        emissive: hasContext ? 0x0038DF : 0x000000,\n        emissiveIntensity: hasContext ? 0.2 : 0,\n        metalness: 0.6,\n        roughness: 0.4\n      });\n\n      const mesh = new THREE.Mesh(geometry, material);\n      mesh.position.set(comp.position.x, comp.position.y, comp.position.z);\n      mesh.rotation.y = comp.rotation * (Math.PI / 180);\n      mesh.userData = { id: comp.id };\n\n      groupRef.current.add(mesh);\n    });\n  }, [components, selectedId, hoveredId, contextMap]);\n\n  // Find hovered component details\n  const hoveredComponent = components.find(c => c.id === hoveredId);\n  const contextDescription = hoveredId ? contextMap[hoveredId] : null;\n\n  return (\n    <div ref={containerRef} className=\"w-full h-full relative\">\n      {hoveredId && hoveredComponent && (\n        <div\n          className=\"absolute pointer-events-none z-50 transform -translate-x-1/2 -translate-y-[80px] animate-in fade-in zoom-in-95 duration-200\"\n          style={{ left: labelPos.x, top: labelPos.y }}\n        >\n          <div className=\"flex flex-col bg-white/90 backdrop-blur-md border border-gray-200 rounded-[10px] p-2 shadow-xl min-w-[120px]\">\n            {contextDescription && (\n              <div className=\"mb-1 pb-1 border-b border-gray-100\">\n                <span className=\"text-[10px] font-bold text-[#0038DF] uppercase tracking-wider block\">AI Context</span>\n                <p className=\"text-[11px] text-gray-600 leading-tight\">{contextDescription}</p>\n              </div>\n            )}\n\n            <div className=\"flex items-center justify-between gap-2\">\n              <span className=\"text-[11px] font-bold text-gray-800\">{hoveredComponent.name}</span>\n              <span className=\"text-[9px] text-gray-500 bg-gray-100 px-1 rounded\">{hoveredComponent.type}</span>\n            </div>\n          </div>\n\n          <div className=\"w-0 h-0 border-l-[6px] border-l-transparent border-r-[6px] border-r-transparent border-t-[6px] border-t-white mx-auto mt-[-1px] filter drop-shadow-sm\" />\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PCBRenderer;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 278, "column": 0}, "map": {"version":3,"sources":["file:///Users/MAC/Projects%202/buildpcbs-eda-demo/src/components/ChatInterface.tsx"],"sourcesContent":["\nimport React, { useRef, useEffect } from 'react';\nimport { Send, Sparkles, Maximize2, ArrowRight } from 'lucide-react';\nimport { AppMode, Message } from '../types';\n\ninterface Props {\n    mode: AppMode;\n    messages: Message[];\n    onSendMessage: (text: string) => void;\n    onPreview: (changeId: string) => void;\n    isLoading: boolean;\n}\n\nconst ChatInterface: React.FC<Props> = ({ mode, messages, onSendMessage, onPreview, isLoading }) => {\n    const [input, setInput] = React.useState('');\n    const messagesEndRef = useRef<HTMLDivElement>(null);\n\n    const scrollToBottom = () => {\n        messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n    };\n\n    useEffect(() => {\n        scrollToBottom();\n    }, [messages]);\n\n    const handleSubmit = (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!input.trim() || isLoading) return;\n        onSendMessage(input);\n        setInput('');\n    };\n\n    // Determine container classes based on mode\n    const containerClasses = (() => {\n        switch (mode) {\n            case 'LANDING':\n                return 'absolute top-[50%] left-1/2 -translate-x-1/2 -translate-y-1/2 w-[640px]';\n            case 'CHAT_PREVIEW':\n                return 'relative w-[640px] mx-auto mt-[10vh] h-[80vh] flex flex-col';\n            case 'SPLIT_VIEW':\n                return 'relative w-full h-full flex flex-col border-r border-gray-200 bg-white';\n            default:\n                return 'hidden';\n        }\n    })();\n\n    const showExamples = mode === 'LANDING' && !isLoading;\n\n    return (\n        <div className={`transition-all duration-700 ease-in-out z-40 ${containerClasses}`}>\n\n            {/* Examples for Landing */}\n            {showExamples && (\n                <div className=\"flex flex-wrap justify-center gap-2 mb-6 animate-in fade-in slide-in-from-bottom-2 duration-700\">\n                    {[\"Dual motor driver\", \"High-efficiency buck converter\", \"OLED display carrier\"].map((ex) => (\n                        <button\n                            key={ex}\n                            onClick={() => onSendMessage(ex)}\n                            className=\"px-4 py-2 rounded-full bg-white border border-gray-200 text-[13px] text-gray-600 hover:border-[#0038DF] hover:text-[#0038DF] transition-all shadow-sm\"\n                        >\n                            {ex}\n                        </button>\n                    ))}\n                </div>\n            )}\n\n            {/* Chat History */}\n            {(mode === 'CHAT_PREVIEW' || mode === 'SPLIT_VIEW') && (\n                <div className={`flex-1 overflow-y-auto mb-2 custom-scrollbar px-4 ${mode === 'CHAT_PREVIEW' ? '' : 'pt-4'}`}>\n                    {messages.map((msg) => (\n                        <div\n                            key={msg.id}\n                            className={`mb-4 flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}\n                        >\n                            <div\n                                className={`max-w-[90%] rounded-[16px] p-3 text-[14px] leading-relaxed shadow-sm ${msg.role === 'user'\n                                        ? 'bg-gray-100 text-gray-900'\n                                        : 'bg-white border border-gray-200 text-gray-800'\n                                    }`}\n                            >\n                                {msg.role === 'assistant' && (\n                                    <div className=\"flex items-center gap-1.5 mb-1 text-[#0038DF]\">\n                                        <Sparkles size={12} />\n                                        <span className=\"text-[10px] font-bold uppercase tracking-wider\">Agent</span>\n                                    </div>\n                                )}\n\n                                <p className=\"whitespace-pre-wrap\">{msg.content}</p>\n\n                                {/* Preview Action */}\n                                {msg.previewData && (\n                                    <div className=\"mt-3 pt-3 border-t border-gray-100\">\n                                        <div className=\"flex items-center justify-between bg-gray-50 rounded-[10px] p-2 border border-gray-100\">\n                                            <div className=\"flex items-center gap-2\">\n                                                <div className=\"w-7 h-7 rounded-full bg-[#0038DF11] flex items-center justify-center text-[#0038DF]\">\n                                                    <Maximize2 size={12} />\n                                                </div>\n                                                <div className=\"flex flex-col\">\n                                                    <span className=\"text-[11px] font-medium text-gray-900\">PCB Update</span>\n                                                    <span className=\"text-[9px] text-gray-500\">Ready to review</span>\n                                                </div>\n                                            </div>\n\n                                            <button\n                                                onClick={() => onPreview(msg.previewData!.changeId)}\n                                                className=\"px-3 py-1.5 bg-[#0038DF] text-white rounded-[6px] text-[10px] font-bold hover:bg-[#002db3] transition-colors flex items-center gap-1.5 shadow-sm\"\n                                            >\n                                                PREVIEW\n                                                <ArrowRight size={10} />\n                                            </button>\n                                        </div>\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                    ))}\n\n                    {isLoading && (\n                        <div className=\"flex justify-start mb-4 px-4\">\n                            <div className=\"bg-white rounded-[16px] p-3 border border-gray-200 flex items-center gap-2 shadow-sm\">\n                                <div className=\"w-1.5 h-1.5 rounded-full bg-[#0038DF] animate-bounce\" />\n                                <div className=\"w-1.5 h-1.5 rounded-full bg-[#0038DF] animate-bounce delay-150\" />\n                                <div className=\"w-1.5 h-1.5 rounded-full bg-[#0038DF] animate-bounce delay-300\" />\n                            </div>\n                        </div>\n                    )}\n\n                    <div ref={messagesEndRef} />\n                </div>\n            )}\n\n            {/* Input Area */}\n            <form\n                onSubmit={handleSubmit}\n                className={`w-full relative group transition-all duration-500 z-50\n          ${mode === 'LANDING'\n                        ? 'shadow-[0_20px_40px_-10px_rgba(0,0,0,0.1)] rounded-[20px]'\n                        : mode === 'SPLIT_VIEW'\n                            ? 'px-4 pb-4 bg-white'\n                            : 'shadow-[0_8px_24px_-8px_rgba(0,0,0,0.1)] rounded-[20px] bg-white'\n                    }\n        `}\n            >\n                <input\n                    type=\"text\"\n                    value={input}\n                    onChange={(e) => setInput(e.target.value)}\n                    disabled={isLoading}\n                    placeholder={mode === 'LANDING' ? \"Describe your board architecture...\" : \"Ask a follow-up...\"}\n                    className={`w-full bg-white border border-gray-200 rounded-[20px] px-5 text-gray-900 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-[#0038DF]/20 focus:border-[#0038DF] transition-all shadow-sm\n            ${mode === 'LANDING' ? 'py-4 text-[16px]' : 'py-3 text-[14px]'}\n          `}\n                />\n\n                <div className={`absolute top-1/2 -translate-y-1/2 flex items-center gap-2\n            ${mode === 'SPLIT_VIEW' ? 'right-6' : 'right-3'}\n        `}>\n                    <button\n                        type=\"submit\"\n                        disabled={!input.trim() || isLoading}\n                        className={`\n              ${mode === 'LANDING' ? 'p-2' : 'p-1.5'}\n              bg-[#0038DF] text-white rounded-full disabled:bg-gray-200 disabled:text-gray-400 transition-all hover:scale-105 active:scale-95 shadow-md shadow-[#0038DF]/20\n            `}\n                    >\n                        <Send size={mode === 'LANDING' ? 18 : 14} />\n                    </button>\n                </div>\n            </form>\n        </div>\n    );\n};\n\nexport default ChatInterface;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 716, "column": 0}, "map": {"version":3,"sources":["file:///Users/MAC/Projects%202/buildpcbs-eda-demo/src/services/geminiService.ts"],"sourcesContent":["\nimport { GoogleGenAI, Type } from \"@google/genai\";\nimport { Component, ChangeCard } from \"../types\";\n\n// Initialize lazily or with dummy to prevent crash on load\nconst getAiClient = () => {\n  const apiKey = process.env.NEXT_PUBLIC_GEMINI_API_KEY || process.env.NEXT_PUBLIC_API_KEY || 'dummy-key';\n  return new GoogleGenAI({ apiKey });\n};\n\n\nconst PCB_SCHEMA = {\n  type: Type.OBJECT,\n  properties: {\n    intent: { type: Type.STRING, description: 'The summarized intent of the user action.' },\n    description: { type: Type.STRING, description: 'User-friendly description of what was changed.' },\n    components: {\n      type: Type.ARRAY,\n      items: {\n        type: Type.OBJECT,\n        properties: {\n          id: { type: Type.STRING },\n          name: { type: Type.STRING },\n          type: { type: Type.STRING },\n          value: { type: Type.STRING },\n          package: { type: Type.STRING },\n          position: {\n            type: Type.OBJECT,\n            properties: {\n              x: { type: Type.NUMBER },\n              y: { type: Type.NUMBER },\n              z: { type: Type.NUMBER }\n            },\n            required: ['x', 'y', 'z']\n          },\n          rotation: { type: Type.NUMBER },\n          net: { type: Type.STRING }\n        },\n        required: ['id', 'name', 'type', 'position']\n      }\n    }\n  },\n  required: ['intent', 'description', 'components']\n};\n\nexport const processPrompt = async (\n  prompt: string,\n  currentComponents: Component[]\n): Promise<{ change: ChangeCard, updatedComponents: Component[] }> => {\n  try {\n    const ai = getAiClient();\n    const response = await ai.models.generateContent({\n      model: 'gemini-2.0-flash', // Updated to latest available model or keep generic if unknown\n      contents: `\n        You are an expert PCB designer and helpful assistant.\n        Current board state components: ${JSON.stringify(currentComponents)}\n        User request: \"${prompt}\"\n        \n        Rules:\n        1. If the user request is a greeting (e.g., \"hi\", \"hello\") or a general question unrelated to the design, DO NOT change any components. Return the \"components\" array exactly as it is. Set \"intent\" to \"GREETING\" (or \"CHAT\" for questions) and \"description\" to a friendly conversational response.\n        2. If the user wants to change the design, update the PCB layout based on the request. Add, move, or modify components as needed.\n        3. Always provide the full component list in the response.\n\n      `,\n      config: {\n        responseMimeType: \"application/json\",\n        responseSchema: PCB_SCHEMA,\n      }\n    });\n\n    const data = JSON.parse(response.text || '{}');\n\n    const change: ChangeCard = {\n      id: Math.random().toString(36).substr(2, 9),\n      intent: data.intent,\n      description: data.description,\n      affectedItems: data.components.map((c: any) => c.name),\n      status: 'applied',\n      timestamp: new Date()\n    };\n\n    return {\n      change,\n      updatedComponents: data.components\n    };\n  } catch (error) {\n    console.error(\"Gemini API Error:\", error);\n    throw error;\n  }\n};\n"],"names":[],"mappings":";;;;AACA;;AAGA,2DAA2D;AAC3D,MAAM,cAAc;IAClB,MAAM,SAAS,QAAQ,GAAG,CAAC,0BAA0B,IAAI,QAAQ,GAAG,CAAC,mBAAmB,IAAI;IAC5F,OAAO,IAAI,yOAAW,CAAC;QAAE;IAAO;AAClC;AAGA,MAAM,aAAa;IACjB,MAAM,kOAAI,CAAC,MAAM;IACjB,YAAY;QACV,QAAQ;YAAE,MAAM,kOAAI,CAAC,MAAM;YAAE,aAAa;QAA4C;QACtF,aAAa;YAAE,MAAM,kOAAI,CAAC,MAAM;YAAE,aAAa;QAAiD;QAChG,YAAY;YACV,MAAM,kOAAI,CAAC,KAAK;YAChB,OAAO;gBACL,MAAM,kOAAI,CAAC,MAAM;gBACjB,YAAY;oBACV,IAAI;wBAAE,MAAM,kOAAI,CAAC,MAAM;oBAAC;oBACxB,MAAM;wBAAE,MAAM,kOAAI,CAAC,MAAM;oBAAC;oBAC1B,MAAM;wBAAE,MAAM,kOAAI,CAAC,MAAM;oBAAC;oBAC1B,OAAO;wBAAE,MAAM,kOAAI,CAAC,MAAM;oBAAC;oBAC3B,SAAS;wBAAE,MAAM,kOAAI,CAAC,MAAM;oBAAC;oBAC7B,UAAU;wBACR,MAAM,kOAAI,CAAC,MAAM;wBACjB,YAAY;4BACV,GAAG;gCAAE,MAAM,kOAAI,CAAC,MAAM;4BAAC;4BACvB,GAAG;gCAAE,MAAM,kOAAI,CAAC,MAAM;4BAAC;4BACvB,GAAG;gCAAE,MAAM,kOAAI,CAAC,MAAM;4BAAC;wBACzB;wBACA,UAAU;4BAAC;4BAAK;4BAAK;yBAAI;oBAC3B;oBACA,UAAU;wBAAE,MAAM,kOAAI,CAAC,MAAM;oBAAC;oBAC9B,KAAK;wBAAE,MAAM,kOAAI,CAAC,MAAM;oBAAC;gBAC3B;gBACA,UAAU;oBAAC;oBAAM;oBAAQ;oBAAQ;iBAAW;YAC9C;QACF;IACF;IACA,UAAU;QAAC;QAAU;QAAe;KAAa;AACnD;AAEO,MAAM,gBAAgB,OAC3B,QACA;IAEA,IAAI;QACF,MAAM,KAAK;QACX,MAAM,WAAW,MAAM,GAAG,MAAM,CAAC,eAAe,CAAC;YAC/C,OAAO;YACP,UAAU,CAAC;;wCAEuB,EAAE,KAAK,SAAS,CAAC,mBAAmB;uBACrD,EAAE,OAAO;;;;;;;MAO1B,CAAC;YACD,QAAQ;gBACN,kBAAkB;gBAClB,gBAAgB;YAClB;QACF;QAEA,MAAM,OAAO,KAAK,KAAK,CAAC,SAAS,IAAI,IAAI;QAEzC,MAAM,SAAqB;YACzB,IAAI,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,MAAM,CAAC,GAAG;YACzC,QAAQ,KAAK,MAAM;YACnB,aAAa,KAAK,WAAW;YAC7B,eAAe,KAAK,UAAU,CAAC,GAAG,CAAC,CAAC,IAAW,EAAE,IAAI;YACrD,QAAQ;YACR,WAAW,IAAI;QACjB;QAEA,OAAO;YACL;YACA,mBAAmB,KAAK,UAAU;QACpC;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qBAAqB;QACnC,MAAM;IACR;AACF"}},
    {"offset": {"line": 844, "column": 0}, "map": {"version":3,"sources":["file:///Users/MAC/Projects%202/buildpcbs-eda-demo/src/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState } from 'react';\nimport PCBRenderer from '@/components/PCBRenderer';\nimport ChatInterface from '@/components/ChatInterface';\nimport { Component, ViewMode, AppMode, Message } from '@/types';\nimport { processPrompt } from '@/services/geminiService';\nimport { ChevronDown } from 'lucide-react';\n\nconst Logo = () => (\n    <svg width=\"100\" height=\"23\" viewBox=\"0 0 100 23\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" className=\"opacity-90\">\n        <rect x=\"0.637891\" y=\"0.637402\" width=\"25.075\" height=\"21.675\" fill=\"#0038DF\" />\n        <rect x=\"0.637891\" y=\"0.637402\" width=\"25.075\" height=\"21.675\" stroke=\"black\" strokeWidth=\"1.275\" />\n        <path d=\"M1.27539 21.6748V11.309H6.92285L10.9567 4.6748L15.7974 17.9431L19.8313 11.7236H25.0754V21.6748H1.27539Z\" fill=\"white\" />\n        <path d=\"M13.1758 11.4748L10.6258 4.6748L6.37578 11.4748H2.12578\" stroke=\"black\" strokeWidth=\"1.7\" strokeLinecap=\"square\" />\n        <path d=\"M13.1758 11.4749L15.7258 18.2749L19.9758 11.4749H24.2258\" stroke=\"black\" strokeWidth=\"1.7\" strokeLinecap=\"square\" />\n        <path d=\"M35.9062 17.6789C35.4415 17.6789 35.0165 17.6109 34.6312 17.4749C34.2572 17.3502 33.9285 17.1745 33.6452 16.9479C33.3619 16.7212 33.1239 16.4605 32.9312 16.1659L32.7612 17.4749H31.2312V5.23485H32.9312V10.2499C33.2032 9.81919 33.5829 9.45652 34.0702 9.16185C34.5689 8.85585 35.1809 8.70285 35.9062 8.70285C36.7222 8.70285 37.4419 8.90119 38.0652 9.29785C38.6885 9.68319 39.1702 10.2159 39.5102 10.8959C39.8615 11.5645 40.0372 12.3352 40.0372 13.2079C40.0372 14.0579 39.8615 14.8229 39.5102 15.5029C39.1702 16.1829 38.6885 16.7155 38.0652 17.1009C37.4419 17.4862 36.7222 17.6789 35.9062 17.6789ZM35.6342 16.1999C36.1555 16.1999 36.6145 16.0752 37.0112 15.8259C37.4192 15.5765 37.7365 15.2252 37.9632 14.7719C38.2012 14.3185 38.3202 13.7915 38.3202 13.1909C38.3202 12.5902 38.2012 12.0689 37.9632 11.6269C37.7365 11.1735 37.4192 10.8222 37.0112 10.5729C36.6145 10.3122 36.1555 10.1819 35.6342 10.1819C35.1015 10.1819 34.6312 10.3122 34.2232 10.5729C33.8265 10.8222 33.5149 11.1735 33.2882 11.6269C33.0615 12.0689 32.9482 12.5902 32.9482 13.1909C32.9482 13.7915 33.0615 14.3185 33.2882 14.7719C33.5149 15.2252 33.8265 15.5765 34.2232 15.8259C34.6312 16.0752 35.1015 16.1999 35.6342 16.1999ZM44.4872 17.6789C43.8185 17.6789 43.2349 17.5429 42.7362 17.2709C42.2489 16.9989 41.8692 16.5909 41.5972 16.0469C41.3365 15.5029 41.2062 14.8172 41.2062 13.9899V8.90685H42.9062V13.8029C42.9062 14.6075 43.0819 15.2139 43.4332 15.6219C43.7845 16.0299 44.2889 16.2339 44.9462 16.2339C45.3882 16.2339 45.7849 16.1262 46.1362 15.9109C46.4989 15.6955 46.7822 15.3839 46.9862 14.9759C47.1902 14.5679 47.2922 14.0692 47.2922 13.4799V8.90685H48.9922V17.4749H47.4792L47.3602 16.0129C47.0995 16.5342 46.7199 16.9422 46.2212 17.2369C45.7225 17.5315 45.1445 17.6789 44.4872 17.6789ZM50.7587 17.4749V8.90685H52.4587V17.4749H50.7587ZM51.6257 7.29185C51.2971 7.29185 51.0251 7.18985 50.8097 6.98585C50.6057 6.78185 50.5037 6.52119 50.5037 6.20385C50.5037 5.89785 50.6057 5.64852 50.8097 5.45585C51.0251 5.25185 51.2971 5.14985 51.6257 5.14985C51.9431 5.14985 52.2094 5.25185 52.4247 5.45585C52.6401 5.64852 52.7477 5.89785 52.7477 6.20385C52.7477 6.52119 52.6401 6.78185 52.4247 6.98585C52.2094 7.18985 51.9431 7.29185 51.6257 7.29185ZM54.2097 17.4749V5.23485H55.9097V17.4749H54.2097ZM61.3719 17.6789C60.5559 17.6789 59.8363 17.4862 59.2129 17.1009C58.5896 16.7042 58.1023 16.1715 57.7509 15.5029C57.4109 14.8229 57.2409 14.0522 57.2409 13.1909C57.2409 12.3182 57.4109 11.5475 57.7509 10.8789C58.1023 10.2102 58.5896 9.68319 59.2129 9.29785C59.8476 8.90119 60.5729 8.70285 61.3889 8.70285C62.0576 8.70285 62.6469 8.83885 63.1569 9.11085C63.6669 9.37152 64.0636 9.74552 64.3469 10.2329V5.23485H66.0469V17.4749H64.5169L64.3469 16.1489C64.1769 16.4095 63.9559 16.6589 63.6839 16.8969C63.4119 17.1235 63.0833 17.3105 62.6979 17.4579C62.3126 17.6052 61.8706 17.6789 61.3719 17.6789ZM61.6439 16.1999C62.1766 16.1999 62.6469 16.0752 63.0549 15.8259C63.4629 15.5765 63.7746 15.2252 63.9899 14.7719C64.2166 14.3185 64.3299 13.7915 64.3299 13.1909C64.3299 12.5902 64.2166 12.0689 63.9899 11.6269C63.7746 11.1735 63.4629 10.8222 63.0549 10.5729C62.6469 10.3122 62.1766 10.1819 61.6439 10.1819C61.1339 10.1819 60.6749 10.3122 60.2669 10.5729C59.8589 10.8222 59.5416 11.1735 59.3149 11.6269C59.0883 12.0689 58.9749 12.5902 58.9749 13.1909C58.9749 13.7915 59.0883 14.3185 59.3149 14.7719C59.5416 15.2252 59.8589 15.5765 60.2669 15.8259C60.6749 16.0752 61.1339 16.1999 61.6439 16.1999ZM67.6915 21.2149V8.90685H69.2215L69.3915 10.2329C69.5729 9.97219 69.7995 9.72852 70.0715 9.50185C70.3435 9.26385 70.6665 9.07119 71.0405 8.92385C71.4259 8.77652 71.8735 8.70285 72.3835 8.70285C73.1995 8.70285 73.9135 8.90119 74.5255 9.29785C75.1489 9.69452 75.6305 10.2329 75.9705 10.9129C76.3219 11.5815 76.4975 12.3465 76.4975 13.2079C76.4975 14.0692 76.3219 14.8399 75.9705 15.5199C75.6192 16.1885 75.1319 16.7155 74.5085 17.1009C73.8965 17.4862 73.1825 17.6789 72.3665 17.6789C71.6979 17.6789 71.1085 17.5485 70.5985 17.2879C70.0885 17.0159 69.6862 16.6419 69.3915 16.1659V21.2149H67.6915ZM72.0945 16.1999C72.6159 16.1999 73.0749 16.0752 73.4715 15.8259C73.8795 15.5765 74.1969 15.2252 74.4235 14.7719C74.6615 14.3185 74.7805 13.7915 74.7805 13.1909C74.7805 12.5902 74.6615 12.0689 74.4235 11.6269C74.1969 11.1735 73.8795 10.8222 73.4715 10.5729C73.0749 10.3122 72.6159 10.1819 72.0945 10.1819C71.5619 10.1819 71.0915 10.3122 70.6835 10.5729C70.2869 10.8222 69.9752 11.1735 69.7485 11.6269C69.5219 12.0689 69.4085 12.5902 69.4085 13.1909C69.4085 13.7915 69.5219 14.3185 69.7485 14.7719C69.9752 15.2252 70.2869 15.5765 70.6835 15.8259C71.0915 16.0752 71.5619 16.1999 72.0945 16.1999ZM82.4776 17.6789C82.0129 17.6789 81.5879 17.6109 81.2026 17.4749C80.8286 17.3502 80.4999 17.1745 80.2166 16.9479C79.9332 16.7212 79.6952 16.4605 79.5026 16.1659L79.3326 17.4749H77.8026V5.23485H79.5026V10.2499C79.7746 9.81919 80.1542 9.45652 80.6416 9.16185C81.1402 8.85585 81.7522 8.70285 82.4776 8.70285C83.2936 8.70285 84.0132 8.90119 84.6366 9.29785C85.2599 9.68319 85.7416 10.2159 86.0816 10.8959C86.4329 11.5645 86.6086 12.3352 86.6086 13.2079C86.6086 14.0579 86.4329 14.8229 86.0816 15.5029C85.7416 16.1829 85.2599 16.7155 84.6366 17.1009C84.0132 17.4862 83.2936 17.6789 82.4776 17.6789ZM82.2056 16.1999C82.7269 16.1999 83.1859 16.0752 83.5826 15.8259C83.9906 15.5765 84.3079 15.2252 84.5346 14.7719C84.7726 14.3185 84.8916 13.7915 84.8916 13.1909C84.8916 12.5902 84.7726 12.0689 84.5346 11.6269C84.3079 11.1735 83.9906 10.8222 83.5826 10.5729C83.1859 10.3122 82.7269 10.1819 82.2056 10.1819C81.6729 10.1819 81.2026 10.3122 80.7946 10.5729C80.3979 10.8222 80.0862 11.1735 79.8596 11.6269C79.6329 12.0689 79.5196 12.5902 79.5196 13.1909C79.5196 13.7915 79.6329 14.3185 79.8596 14.7719C80.0862 15.2252 80.3979 15.5765 80.7946 15.8259C81.2026 16.0752 81.6729 16.1999 82.2056 16.1999ZM91.8746 17.6789C91.0472 17.6789 90.3106 17.4919 89.6646 17.1179C89.0186 16.7325 88.5086 16.2055 88.1346 15.5369C87.7719 14.8682 87.5906 14.0919 87.5906 13.2079C87.5906 12.3125 87.7719 11.5305 88.1346 10.8619C88.5086 10.1819 89.0186 9.65485 89.6646 9.28085C90.3106 8.89552 91.0472 8.70285 91.8746 8.70285C92.9172 8.70285 93.7899 8.97485 94.4926 9.51885C95.1952 10.0629 95.6429 10.7995 95.8356 11.7289H94.0676C93.9542 11.2302 93.6936 10.8449 93.2856 10.5729C92.8889 10.3009 92.4129 10.1649 91.8576 10.1649C91.4042 10.1649 90.9849 10.2839 90.5996 10.5219C90.2142 10.7485 89.9026 11.0885 89.6646 11.5419C89.4379 11.9839 89.3246 12.5335 89.3246 13.1909C89.3246 13.6782 89.3926 14.1145 89.5286 14.4999C89.6646 14.8739 89.8459 15.1912 90.0726 15.4519C90.3106 15.7125 90.5826 15.9109 90.8886 16.0469C91.1946 16.1715 91.5176 16.2339 91.8576 16.2339C92.2316 16.2339 92.5659 16.1772 92.8606 16.0639C93.1666 15.9392 93.4216 15.7579 93.6256 15.5199C93.8409 15.2819 93.9882 14.9985 94.0676 14.6699H95.8356C95.6429 15.5765 95.1952 16.3075 94.4926 16.8629C93.7899 17.4069 92.9172 17.6789 91.8746 17.6789Z\" fill=\"#444444\" />\n    </svg>\n);\n\nconst Home: React.FC = () => {\n    const [appMode, setAppMode] = useState<AppMode>('LOGIN');\n    const [messages, setMessages] = useState<Message[]>([]);\n    const [isProcessing, setIsProcessing] = useState(false);\n    const [components, setComponents] = useState<Component[]>([]);\n    const [view, setView] = useState<ViewMode>('3D');\n    const [componentContext, setComponentContext] = useState<Record<string, string>>({});\n\n    // Derived states\n    const isSplit = appMode === 'SPLIT_VIEW';\n\n    const handlePrompt = async (text: string) => {\n        setIsProcessing(true);\n\n        // Add User Message\n        const userMsg: Message = {\n            id: Date.now().toString(),\n            role: 'user',\n            content: text,\n            timestamp: new Date()\n        };\n        setMessages(prev => [...prev, userMsg]);\n\n        // Transition to Chat Preview if in Landing\n        if (appMode === 'LANDING') {\n            setAppMode('CHAT_PREVIEW');\n        }\n\n        try {\n            const result = await processPrompt(text, components);\n            setComponents(result.updatedComponents);\n\n            // Update context map\n            const newContext = { ...componentContext };\n            result.change.affectedItems.forEach(name => {\n                const comp = result.updatedComponents.find(c => c.name === name);\n                if (comp) {\n                    newContext[comp.id] = result.change.intent;\n                }\n            });\n            setComponentContext(newContext);\n\n            // Add Assistant Message with Preview\n            const isChat = ['GREETING', 'CHAT'].includes(result.change.intent.toUpperCase());\n            const aiMsg: Message = {\n                id: (Date.now() + 1).toString(),\n                role: 'assistant',\n                content: result.change.description,\n                timestamp: new Date(),\n                previewData: isChat ? undefined : {\n                    changeId: result.change.id,\n                    description: result.change.intent,\n                    affectedItems: result.change.affectedItems\n                }\n            };\n            setMessages(prev => [...prev, aiMsg]);\n\n        } catch (err) {\n            console.error(err);\n            const errorMsg: Message = {\n                id: (Date.now() + 1).toString(),\n                role: 'assistant',\n                content: \"I encountered an error processing your request. Please try again.\",\n                timestamp: new Date()\n            };\n            setMessages(prev => [...prev, errorMsg]);\n        } finally {\n            setIsProcessing(false);\n        }\n    };\n\n    const handlePreview = (changeId: string) => {\n        setAppMode('SPLIT_VIEW');\n        // Optional: Select the component related to changeId\n    };\n\n    const handleLogin = () => {\n        setAppMode('LANDING');\n    }\n\n    return (\n        <div className=\"relative h-screen w-full bg-white text-gray-800 overflow-hidden font-['DM_Sans']\">\n\n            {/* Immersive Background / Main Canvas */}\n            <div className={`\n                absolute inset-0 transition-all duration-[1000ms] cubic-bezier(0.4, 0, 0.2, 1)\n                ${appMode === 'LOGIN' ? 'opacity-0 scale-105' : ''}\n                ${appMode === 'LANDING' ? 'opacity-20 scale-110' : ''}\n                ${appMode === 'CHAT_PREVIEW' ? 'opacity-10 scale-105 blur-[2px]' : ''}\n                ${appMode === 'SPLIT_VIEW' ? 'left-[30%] w-[70%] opacity-100 scale-100' : 'w-full'}\n            `}>\n                <PCBRenderer\n                    components={components}\n                    selectedId={null}\n                    onSelect={() => { }}\n                    contextMap={componentContext}\n                />\n            </div>\n\n            {/* Login Overlay */}\n            {appMode === 'LOGIN' && (\n                <div className=\"absolute inset-0 z-50 flex items-center justify-center bg-white\">\n                    <div className=\"flex flex-col items-center animate-in fade-in zoom-in-95 duration-700\">\n                        <div className=\"mb-8 scale-150\">\n                            <Logo />\n                        </div>\n                        <button\n                            onClick={handleLogin}\n                            className=\"px-8 py-3 bg-[#0038DF] text-white rounded-full font-bold text-sm hover:bg-[#002db3] transition-all shadow-lg hover:shadow-xl hover:scale-105\"\n                        >\n                            Sign In to Build\n                        </button>\n                    </div>\n                </div>\n            )}\n\n            {/* Chat Interface Container */}\n            <div className={`\n                z-40 transition-all duration-700 cubic-bezier(0.4, 0, 0.2, 1)\n                ${appMode === 'LOGIN' ? 'opacity-0 translate-y-10 pointer-events-none' : 'opacity-100 translate-y-0'}\n                ${appMode === 'SPLIT_VIEW'\n                    ? 'fixed left-0 top-0 h-full w-[30%] bg-white border-r border-gray-100 shadow-2xl'\n                    : 'absolute inset-0 pointer-events-none'\n                }\n            `}>\n                <div className=\"w-full h-full pointer-events-auto\">\n                    <ChatInterface\n                        mode={appMode}\n                        messages={messages}\n                        onSendMessage={handlePrompt}\n                        onPreview={handlePreview}\n                        isLoading={isProcessing}\n                    />\n                </div>\n            </div>\n\n            {/* Top Right Controls (View Modes) */}\n            {!isSplit && appMode !== 'LANDING' && appMode !== 'LOGIN' && (\n                <div className=\"absolute top-8 right-8 z-40\">\n                    <button\n                        onClick={() => setAppMode('SPLIT_VIEW')}\n                        className=\"bg-white border border-gray-200 p-3 rounded-full hover:bg-gray-50 text-gray-500 hover:text-[#0038DF] transition-all shadow-sm\"\n                    >\n                        <ChevronDown className=\"rotate-[-90deg]\" size={20} />\n                    </button>\n                </div>\n            )}\n\n            {/* Current File Header */}\n            {appMode !== 'LANDING' && appMode !== 'LOGIN' && (\n                <div className={`absolute top-8 left-8 z-40 transition-all duration-500 ${isSplit ? 'opacity-0 translate-x-[-20px]' : 'opacity-100 translate-x-0'}`}>\n                    <div className=\"bg-white border border-gray-200 rounded-[20px] px-4 py-2.5 flex items-center gap-3 shadow-sm hover:shadow-md transition-shadow\">\n                        <div className=\"scale-75\"><Logo /></div>\n                        <p className=\"text-[12px] font-bold text-gray-500 tracking-tight uppercase\">current_file.edat</p>\n                    </div>\n                </div>\n            )}\n\n            {/* Fidelity Control - Only in Split View */}\n            {isSplit && (\n                <div className=\"absolute top-8 right-8 z-40 flex bg-white border border-gray-200 rounded-[14px] p-1 shadow-md\">\n                    {(['Schematic', 'Layout', '3D'] as ViewMode[]).map((v) => (\n                        <button\n                            key={v}\n                            onClick={() => setView(v)}\n                            className={`px-4 py-1.5 rounded-[10px] text-[11px] font-bold transition-all ${view === v ? 'bg-[#0038DF] text-white shadow-sm' : 'text-gray-400 hover:text-gray-800'\n                                }`}\n                        >\n                            {v}\n                        </button>\n                    ))}\n                </div>\n            )}\n\n            {/* Footer / Status */}\n            {!['LANDING', 'LOGIN'].includes(appMode) && (\n                <div className=\"absolute bottom-8 right-8 z-40 flex items-center gap-4 bg-white/80 backdrop-blur-md border border-gray-100 px-4 py-2 rounded-full shadow-sm\">\n                    <div className=\"flex items-center gap-2\">\n                        <div className=\"w-1.5 h-1.5 rounded-full bg-[#3EE28B]\" />\n                        <span className=\"text-[10px] font-bold text-gray-500 uppercase tracking-widest\">DRC: CLEAN</span>\n                    </div>\n                    <div className=\"w-px h-3 bg-gray-200\" />\n                    <span className=\"text-[10px] font-bold text-gray-500 uppercase tracking-widest\">GRID: 0.1MM</span>\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default Home;\n"],"names":[],"mappings":"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"}}]
}